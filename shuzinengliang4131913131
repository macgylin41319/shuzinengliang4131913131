<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜“ç»æ•°å­—èƒ½é‡å¤§å¸ˆ - å…¨èƒ½å°Šäº«ç‰ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --gold: #d4af37;
            --gold-dim: #8a7020;
            --bg-dark: #0f0f13;
            --card-bg: #1c1c21;
            --text-main: #e0e0e0;
            --red-auspicious: #c92a2a; /* å‰æ˜Ÿçº¢ */
            --green-inauspicious: #2b8a3e; /* å‡¶æ˜Ÿç»¿ (æ˜“ç»ä¸­æœ¨å…‹åœŸï¼Œå¸¸ç”¨ç»¿ä»£è¡¨å˜æ•°) */
            --purple-noble: #5f3dc4; /* è´µäºº/å¤©åŒ» */
        }

        body {
            font-family: 'PingFang SC', 'Heiti SC', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        header {
            background: radial-gradient(circle at center, #2a2a35 0%, #000 100%);
            padding: 2rem 1rem;
            text-align: center;
            border-bottom: 2px solid var(--gold);
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.2);
        }

        header h1 {
            color: var(--gold);
            margin: 0;
            font-size: 2rem;
            text-transform: uppercase;
            letter-spacing: 4px;
        }

        header .subtitle {
            font-size: 0.9rem;
            color: #888;
            margin-top: 10px;
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* é€‰é¡¹å¡åˆ‡æ¢ */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            background: var(--card-bg);
            border-radius: 30px;
            padding: 5px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            color: #888;
            cursor: pointer;
            font-size: 1rem;
            transition: 0.3s;
            border-radius: 25px;
        }

        .tab-btn.active {
            background: var(--gold);
            color: #000;
            font-weight: bold;
        }

        /* è¾“å…¥åŒºåŸŸ */
        .input-section {
            background: linear-gradient(145deg, #25252b, #18181d);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            border: 1px solid #333;
        }

        input {
            width: 80%;
            padding: 15px;
            font-size: 1.4rem;
            border: 2px solid #444;
            background: #111;
            color: var(--gold);
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
            letter-spacing: 3px;
            outline: none;
            transition: 0.3s;
        }

        input:focus {
            border-color: var(--gold);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }

        .action-btn {
            background: linear-gradient(90deg, #d4af37, #f2d06b);
            color: #000;
            font-weight: 800;
            border: none;
            padding: 15px 50px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
            transform: translateY(0);
            transition: 0.2s;
        }

        .action-btn:active {
            transform: translateY(2px);
        }

        /* ç»“æœå¡ç‰‡ */
        .card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid var(--gold);
            position: relative;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card h3 {
            color: var(--gold);
            margin-top: 0;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* æ•°ç»„å±•ç¤º */
        .number-flow {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }

        .flow-item {
            background: #2b2b35;
            padding: 10px 15px;
            border-radius: 8px;
            text-align: center;
            min-width: 60px;
            position: relative;
        }

        .flow-num { font-size: 1.5rem; font-weight: bold; display: block; }
        .flow-star { font-size: 0.9rem; margin-top: 5px; display: block; }
        
        /* å‰å‡¶é¢œè‰²ç±» */
        .star-tianyi, .star-shengqi, .star-yannian, .star-fuwei { color: #ff6b6b; } /* å‰ */
        .star-wugui, .star-jueming, .star-huohai, .star-liusha { color: #69db7c; } /* å‡¶ */
        
        /* æ ‡ç­¾ */
        .tag {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            color: #fff;
        }
        .bg-ji { background-color: #c92a2a; }
        .bg-xiong { background-color: #2b8a3e; }
        .bg-neutral { background-color: #555; }

        .score-display {
            font-size: 3rem;
            font-weight: bold;
            color: var(--gold);
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
            text-align: center;
            margin: 20px 0;
        }

        .advice-box {
            background: rgba(212, 175, 55, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px dashed var(--gold);
            margin-top: 15px;
        }

    </style>
</head>
<body>

<header>
    <h1>æ˜“ç»æ•°å­—èƒ½é‡</h1>
    <div class="subtitle">å…«æ˜Ÿç£åœº Â· å‰å‡¶æ¨æ¼” Â· è¿åŠ¿åŒ–è§£</div>
</header>

<div class="container">
    
    <div class="tabs">
        <button class="tab-btn active" onclick="setMode('phone')">æ‰‹æœºå·ç </button>
        <button class="tab-btn" onclick="setMode('car')">è½¦ç‰Œåˆ†æ</button>
        <button class="tab-btn" onclick="setMode('birth')">ç”Ÿè¾°åˆ†æ</button>
    </div>

    <div class="input-section">
        <div id="input-label" style="margin-bottom:10px; color:#aaa;">è¯·è¾“å…¥11ä½æ‰‹æœºå·ç </div>
        <input type="text" id="mainInput" placeholder="ä¾‹å¦‚ï¼š13912345678" onkeypress="if(event.keyCode==13) analyze()">
        <br>
        <button class="action-btn" onclick="analyze()">ç«‹å³è§£ç </button>
    </div>

    <div id="result-area" style="display:none;">
        
        <div class="card">
            <h3>ğŸ›¡ï¸ ç£åœºæ€»è¯„ä¸å¾—åˆ†</h3>
            <div class="score-display" id="total-score">0</div>
            <p style="text-align:center; color:#ccc;" id="score-desc">æ­£åœ¨è®¡ç®—...</p>
            <canvas id="balanceChart" height="100"></canvas>
        </div>

        <div class="card">
            <h3>ğŸ”¢ æ•°å­—ç£åœºæµå‘è§£æ</h3>
            <p style="font-size:0.9rem; color:#888;">ä¾æ®ã€Šæ˜“ç»ã€‹0/5ç‰¹æ®Šè§„åˆ™ï¼ˆ0ä¸ºéš/ä¼ä½ï¼Œ5ä¸ºæ¡¥/åŠ å¼ºï¼‰è‡ªåŠ¨è½¬æ¢</p>
            <div class="number-flow" id="star-flow">
                </div>
        </div>

        <div class="card">
            <h3>ğŸ“– å‘½æ ¼è¯¦ç»†è§£è¯»</h3>
            <div id="detailed-analysis"></div>
        </div>

        <div class="card">
            <h3>ğŸ’¡ è¿åŠ¿åŒ–è§£ä¸å»ºè®®</h3>
            <div id="remedy-area"></div>
        </div>
    </div>
</div>

<script>
    // --- æ ¸å¿ƒæ•°æ®é…ç½® ---
    
    // å…«æ˜Ÿç£åœºå­—å…¸ (ç­‰çº§ä»å¼ºåˆ°å¼±)
    const STARS = {
        'TianYi': { name: 'å¤©åŒ»', type: 'å‰', desc: 'è´¢å¯Œã€æ­£æ¡ƒèŠ±ã€å¥åº·', color: 'star-tianyi', pairs: ['13','31','68','86','49','94','27','72'] },
        'ShengQi': { name: 'ç”Ÿæ°”', type: 'å‰', desc: 'è´µäººã€äººè„‰ã€å¼€æœ—', color: 'star-shengqi', pairs: ['14','41','67','76','39','93','28','82'] },
        'YanNian': { name: 'å»¶å¹´', type: 'å‰', desc: 'äº‹ä¸šã€é¢†å¯¼ã€å¼ºåŠ¿', color: 'star-yannian', pairs: ['19','91','78','87','34','43','26','62'] },
        'FuWei':   { name: 'ä¼ä½', type: 'å¹³', desc: 'ç­‰å¾…ã€ä¿å®ˆã€è“„åŠ¿', color: 'star-fuwei', pairs: ['11','22','33','44','55','66','77','88','99','00'] },
        'JueMing': { name: 'ç»å‘½', type: 'å‡¶', desc: 'å†²åŠ¨ã€ç ´è´¢ã€æç«¯', color: 'star-jueming', pairs: ['12','21','69','96','48','84','37','73'] },
        'WuGui':   { name: 'äº”é¬¼', type: 'å‡¶', desc: 'å˜åŠ¨ã€æ‰åã€åè¦†', color: 'star-wugui', pairs: ['18','81','79','97','36','63','24','42'] },
        'LiuSha':  { name: 'å…­ç…', type: 'å‡¶', desc: 'å¼‚æ€§ç¼˜ã€æƒ…ç»ªã€çº è‘›', color: 'star-liusha', pairs: ['16','61','47','74','38','83','29','92'] },
        'HuoHai':  { name: 'ç¥¸å®³', type: 'å‡¶', desc: 'å£èˆŒã€ç–¾ç—…ã€å°äºº', color: 'star-huohai', pairs: ['17','71','89','98','46','64','23','32'] }
    };

    // å­—æ¯æ˜ å°„è¡¨ (ç”¨äºè½¦ç‰Œ)
    const LETTER_MAP = {
        'A': '01', 'B': '02', 'C': '03', 'D': '04', 'E': '05', 'F': '06', 'G': '07', 'H': '08', 'I': '09',
        'J': '10', 'K': '11', 'L': '12', 'M': '13', 'N': '14', 'O': '15', 'P': '16', 'Q': '17', 'R': '18',
        'S': '19', 'T': '20', 'U': '21', 'V': '22', 'W': '23', 'X': '24', 'Y': '25', 'Z': '26'
    };

    let currentMode = 'phone';
    let chartInstance = null;

    // --- ç•Œé¢äº¤äº’é€»è¾‘ ---

    function setMode(mode) {
        currentMode = mode;
        const input = document.getElementById('mainInput');
        const label = document.getElementById('input-label');
        const btns = document.querySelectorAll('.tab-btn');
        
        btns.forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');

        document.getElementById('result-area').style.display = 'none';
        input.value = '';

        if(mode === 'phone') {
            label.innerText = 'è¯·è¾“å…¥æ‰‹æœºå·ç  (11ä½)';
            input.placeholder = '13912345678';
        } else if(mode === 'car') {
            label.innerText = 'è¯·è¾“å…¥è½¦ç‰Œå· (å¦‚: F2B39)';
            input.placeholder = 'F2B39 (ä¸å«åœ°åŒºå‰ç¼€)';
        } else {
            label.innerText = 'è¯·è¾“å…¥å‡ºç”Ÿå¹´æœˆæ—¥ (å¦‚: 19781223)';
            input.placeholder = '19781223';
        }
    }

    function analyze() {
        let rawInput = document.getElementById('mainInput').value.toUpperCase().trim();
        if(!rawInput) return;

        // 1. é¢„å¤„ç†ï¼šå¦‚æœæ˜¯è½¦ç‰Œï¼Œå…ˆæŠŠå­—æ¯è½¬æ•°å­—
        let processedStr = rawInput;
        if (currentMode === 'car') {
            processedStr = convertCarPlate(rawInput);
        } else {
            // ç§»é™¤éæ•°å­—å­—ç¬¦
            processedStr = rawInput.replace(/\D/g, '');
        }

        // 2. ç”Ÿæˆæ•°ç»„å¯¹ (æ ¸å¿ƒé€»è¾‘ï¼šå¤„ç†0å’Œ5)
        const pairs = generatePairs(processedStr);
        
        // 3. åŒ¹é…å…«æ˜Ÿ
        const analysisResults = mapStars(pairs);

        // 4. æ¸²æŸ“ç»“æœ
        renderUI(analysisResults);
    }

    // --- æ ¸å¿ƒç®—æ³• ---

    // è½¦ç‰Œè½¬æ•°å­—é€»è¾‘
    function convertCarPlate(str) {
        let res = '';
        for(let char of str) {
            if(/[A-Z]/.test(char)) {
                res += LETTER_MAP[char];
            } else if(/[0-9]/.test(char)) {
                res += char;
            }
        }
        return res;
    }

    // ç”Ÿæˆæ•°ç»„å¯¹ (0å’Œ5çš„ç‰¹æ®Šè§„åˆ™)
    function generatePairs(str) {
        let pairs = [];
        let len = str.length;

        for (let i = 0; i < len - 1; i++) {
            let curr = str[i];
            let next = str[i+1];

            // è§„åˆ™1ï¼šé‡åˆ°0
            // é€»è¾‘ï¼šX0 -> XX (å‰æ•°ä¼ä½), 0Y -> YY (åæ•°ä¼ä½)
            // æ ¹æ®ç”¨æˆ·æ–‡æ¡£ï¼šB1306 -> 306 -> 33, 66
            if (next === '0') {
                // å½“å‰æ•°å½¢æˆä¼ä½
                pairs.push(curr + curr);
                // æ£€æŸ¥0åé¢æ˜¯å¦æœ‰æ•°å­—
                if (i + 2 < len) {
                    let afterZero = str[i+2];
                    // 0åé¢çš„æ•°ä¹Ÿå½¢æˆä¼ä½ (0Y -> YY)
                    // æ³¨æ„ï¼šå¾ªç¯ä¼šè‡ªç„¶èµ°åˆ° 0ï¼Œæˆ‘ä»¬éœ€è¦è·³è¿‡å¤„ç†å—ï¼Ÿ
                    // æŒ‰ç…§ç”¨æˆ·é€»è¾‘ï¼Œ06 -> 66ã€‚
                    // è¿™é‡Œæˆ‘ä»¬åªå¤„ç†å½“å‰ i å’Œ i+1 çš„å…³ç³»ã€‚
                    // å½“ i èµ°åˆ° 0 çš„ä½ç½®æ—¶ï¼Œcurr='0', next='6' -> 06ã€‚
                    // 0å¼€å¤´/ä¸­é—´è§„åˆ™ï¼š06 -> 66ã€‚
                }
            } 
            // è§„åˆ™2ï¼šé‡åˆ°5
            // é€»è¾‘ï¼šX5Y -> XY (æ¡¥æ¢ï¼Œè¿æ¥)
            else if (next === '5') {
                // å¯»æ‰¾5ä¹‹åç¬¬ä¸€ä¸ªé5çš„æ•°å­—
                let j = i + 1;
                while(j < len && str[j] === '5') {
                    j++;
                }
                if (j < len) {
                    pairs.push(curr + str[j]); // è·¨è¶Š5è¿æ¥
                }
            }
            // è§„åˆ™3ï¼šå½“å‰æ˜¯0 (0åœ¨é¦–ä½æˆ–ä¸­é—´è¢«ä½œä¸ºcurr)
            else if (curr === '0') {
                // 06 -> 66 (0å˜åæ•°)
                pairs.push(next + next);
            }
            // è§„åˆ™4ï¼šå½“å‰æ˜¯5 (5å¼€å¤´)
            else if (curr === '5') {
                // 58... -> 88... (5å˜åæ•°)
                pairs.push(next + next);
            }
            // å¸¸è§„æƒ…å†µ
            else {
                pairs.push(curr + next);
            }
        }
        
        // è¿‡æ»¤ï¼šå¤„ç†5ä½œä¸ºæ¡¥æ¢æ—¶å¯èƒ½äº§ç”Ÿçš„å†—ä½™ï¼Œæˆ–è€…ä¸¥æ ¼æŒ‰æ­¥è¿›å¤„ç†
        // ä¸Šé¢çš„å¾ªç¯æ˜¯æ­¥è¿›çš„ã€‚
        // å¦‚æœåºåˆ—æ˜¯ 153
        // i=0: curr=1, next=5. Push '13'.
        // i=1: curr=5, next=3. Push '33'. (5å˜åæ•°) -> ç”¨æˆ·æ–‡æ¡£æ²¡æ˜ç¡®è¯´æ˜¯ä¼ä½ï¼Œä½†è¯´ 584 -> 884ã€‚
        // ä¿®æ­£é€»è¾‘ï¼š5ä½œä¸ºè¿æ¥æ¡¥æ¢ï¼Œä¸åº”äº§ç”Ÿå•ç‹¬çš„å¯¹å­ï¼Œé™¤é5åœ¨å¼€å¤´ã€‚
        // ä¸ºäº†ç®€åŒ–ä¸”ç¬¦åˆå¤§å¤šæ•°æ•°å­—èƒ½é‡é€»è¾‘ï¼š
        // é‡æ–°å†™ä¸€ä¸ªæ›´ä¸¥è°¨çš„æµå¼è§£æï¼š
        
        return advancedPairLogic(str);
    }

    // ä¸¥è°¨çš„ 0/5 è§£æå™¨
    function advancedPairLogic(str) {
        let resultPairs = [];
        for (let i = 0; i < str.length - 1; i++) {
            let a = str[i];
            let b = str[i+1];
            
            // å¿½ç•¥å½“æ¬¡å¾ªç¯çš„ b æ˜¯ 5 çš„æƒ…å†µï¼Ÿä¸å¯¹ï¼Œè¿™ä¼šæ¼æ‰ã€‚
            // è®©æˆ‘ä»¬æ ¹æ®â€œç»“æœå¯¼å‘â€
            
            // æƒ…å†µ A: æ­£å¸¸æ•°å­—
            if (a !== '0' && a !== '5' && b !== '0' && b !== '5') {
                resultPairs.push(a + b);
            }
            // æƒ…å†µ B: åŒ…å« 0 (éšæ€§/ä¼ä½)
            // 10 -> 11
            else if (b === '0') {
                resultPairs.push(a + a); 
            }
            else if (a === '0') {
                resultPairs.push(b + b);
            }
            // æƒ…å†µ C: åŒ…å« 5 (åŠ å¼º/æ¡¥æ¢)
            // 15 -> å¯»æ‰¾ä¸‹ä¸‹ä¸ª
            else if (b === '5') {
                let k = i + 1;
                while (k < str.length && str[k] === '5') k++;
                if (k < str.length) {
                    resultPairs.push(a + str[k]);
                }
            }
            // 5åœ¨å¼€å¤´
            else if (a === '5') {
                resultPairs.push(b + b);
            }
        }
        // å»é‡æˆ–ä¿ç•™æµå‘ï¼Ÿæ•°å­—èƒ½é‡å­¦çœ‹é‡æµå‘ï¼Œä¿ç•™æ‰€æœ‰ç”Ÿæˆçš„å¯¹å­ã€‚
        return resultPairs;
    }

    function mapStars(pairs) {
        return pairs.map(pair => {
            let starKey = null;
            for (let key in STARS) {
                if (STARS[key].pairs.includes(pair)) {
                    starKey = key;
                    break;
                }
            }
            return { pair, starKey, info: STARS[starKey] };
        }).filter(item => item.starKey); // è¿‡æ»¤æ— æ•ˆç»„åˆ
    }

    // --- æ¸²æŸ“é€»è¾‘ ---

    function renderUI(results) {
        document.getElementById('result-area').style.display = 'block';
        
        // 1. æ¸²æŸ“æ•°ç»„æµ
        const flowContainer = document.getElementById('star-flow');
        flowContainer.innerHTML = '';
        
        let stats = { good: 0, bad: 0, types: {} };
        let score = 0;

        results.forEach(item => {
            const div = document.createElement('div');
            div.className = 'flow-item';
            div.style.borderBottom = `3px solid ${item.info.type === 'å‰' || item.info.type === 'å¹³' ? '#c92a2a' : '#2b8a3e'}`;
            div.innerHTML = `
                <span class="flow-num">${item.pair}</span>
                <span class="flow-star ${item.info.color}">${item.info.name}</span>
            `;
            flowContainer.appendChild(div);

            // ç»Ÿè®¡
            if(item.info.type === 'å‰') { stats.good++; score += 10; }
            if(item.info.type === 'å‡¶') { stats.bad++; score -= 10; }
            if(item.info.type === 'å¹³') { score += 2; } // ä¼ä½ç•¥å‰
            
            if(!stats.types[item.starKey]) stats.types[item.starKey] = 0;
            stats.types[item.starKey]++;
        });

        // 2. æ›´æ–°åˆ†æ•°ä¸å›¾è¡¨
        const scoreEl = document.getElementById('total-score');
        scoreEl.innerText = score;
        scoreEl.style.color = score >= 0 ? '#d4af37' : '#2b8a3e';
        document.getElementById('score-desc').innerText = score > 20 ? 'å¤§å‰ Â· èƒ½é‡é¡ºç•…' : (score < -20 ? 'éœ€åŒ–è§£ Â· å‡¶æ˜Ÿå¹²æ‰°' : 'å¹³ç¨³ Â· å‰å‡¶å‚åŠ');

        renderChart(stats);

        // 3. è¯¦ç»†è§£è¯»
        generateDetailedText(stats, results);

        // 4. åŒ–è§£å»ºè®® (æ ¸å¿ƒé€»è¾‘)
        generateRemedy(stats, results);
    }

    function generateDetailedText(stats, results) {
        const container = document.getElementById('detailed-analysis');
        let html = '<ul style="padding-left:20px; color:#ccc;">';
        
        // æå–ä¸»è¦ç£åœº
        let dominant = Object.keys(stats.types).sort((a,b) => stats.types[b] - stats.types[a])[0];
        if(dominant) {
            let info = STARS[dominant];
            html += `<li><strong>ä¸»å¯¼ç£åœº [${info.name}]ï¼š</strong> ${info.desc}ã€‚æ­¤å·ç ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šï¼Œæ·±åˆ»å½±å“æ‚¨çš„æ€§æ ¼ä¸è¿åŠ¿ã€‚</li>`;
        }

        // æ£€æŸ¥ç‰¹å®šç»„åˆ
        let hasTianYi = stats.types['TianYi'] > 0;
        let hasJueMing = stats.types['JueMing'] > 0;
        
        if(hasTianYi) html += `<li><strong style="color:var(--red-auspicious)">è´¢è¿åˆ†æï¼š</strong> åŒ…å«å¤©åŒ»ç£åœºï¼Œé¢„ç¤ºæ­£è´¢è¿ä½³ï¼Œæœ‰è´µäººç›¸åŠ©ï¼Œé€‚åˆåˆ›ä¸šæˆ–æŠ•èµ„ã€‚</li>`;
        if(hasJueMing) html += `<li><strong style="color:var(--green-inauspicious)">é£é™©æç¤ºï¼š</strong> åŒ…å«ç»å‘½ç£åœºï¼Œæ€§æ ¼æ˜“å†²åŠ¨ï¼Œéœ€æ³¨æ„è‚è‚¾å¥åº·åŠè´¢åŠ¡å¤§èµ·å¤§è½ã€‚</li>`;
        if(stats.types['WuGui'] > 0) html += `<li><strong>å˜åŠ¨æç¤ºï¼š</strong> äº”é¬¼ç£åœºå­˜åœ¨ï¼Œé¢„ç¤ºæ€ç»´æ´»è·ƒä½†å¤šå˜ï¼Œéœ€é˜²å¿ƒè„‘è¡€ç®¡é—®é¢˜æˆ–è¡€å…‰ä¹‹ç¾ã€‚</li>`;

        html += '</ul>';
        container.innerHTML = html;
    }

    function generateRemedy(stats, results) {
        const container = document.getElementById('remedy-area');
        let html = '';
        
        // ç»å‘½åŒ–è§£é€»è¾‘ï¼šå¤©åŒ»æ¬ºç»å‘½
        if (stats.types['JueMing'] > 0) {
            if (stats.types['TianYi'] >= stats.types['JueMing']) {
                html += `<div class="advice-box">âœ… <strong>ç»å‘½å·²åŒ–è§£ï¼š</strong> æ‚¨çš„å·ç ä¸­è™½ç„¶æœ‰ç»å‘½ï¼Œä½†æœ‰è¶³å¤Ÿçš„å¤©åŒ»ç£åœºè¿›è¡Œå‹åˆ¶ï¼ˆå¤©åŒ»æ¬ºç»å‘½ï¼‰ï¼Œè½¬å‡¶ä¸ºå‰ï¼Œè´¢è¿å¯å®ˆã€‚</div>`;
            } else {
                html += `<div class="advice-box">âš ï¸ <strong>ç»å‘½éœ€åŒ–è§£ï¼š</strong> ç»å‘½ç£åœºè¿‡å¼ºï¼Œå»ºè®®å¢åŠ â€œå¤©åŒ»â€æ•°å­—ï¼ˆ13, 68, 94ç­‰ï¼‰æ¥ä¿æŠ¤è´¢åº“å’Œå¥åº·ã€‚</div>`;
            }
        }

        // å…­ç…åŒ–è§£é€»è¾‘ï¼šå»¶å¹´å‹å…­ç…
        if (stats.types['LiuSha'] > 0) {
            if (stats.types['YanNian'] >= stats.types['LiuSha']) {
                html += `<div class="advice-box">âœ… <strong>å…­ç…å·²åŒ–è§£ï¼š</strong> å»¶å¹´é‡‘å…‹å…­ç…æ°´ï¼Œæ‚¨çš„äº‹ä¸šè¿å‹åˆ¶äº†çƒ‚æ¡ƒèŠ±å’Œæƒ…ç»ªåŒ–ã€‚</div>`;
            } else {
                html += `<div class="advice-box">âš ï¸ <strong>å…­ç…éœ€åŒ–è§£ï¼š</strong> çƒ‚æ¡ƒèŠ±æˆ–æƒ…ç»ªé—®é¢˜è¾ƒæ˜¾ï¼Œå»ºè®®å¢åŠ â€œå»¶å¹´â€æ•°å­—ï¼ˆ19, 78ç­‰ï¼‰æ¥å¢å¼ºå®šåŠ›å’Œå®¶åº­å’Œè°ã€‚</div>`;
            }
        }

        // ç¥¸å®³åŒ–è§£é€»è¾‘
        if (stats.types['HuoHai'] > 0) {
             html += `<div class="advice-box">â„¹ï¸ <strong>ç¥¸å®³åŒ–è§£ï¼š</strong> å£èˆŒæ˜¯éå¤šã€‚å£è¯€ï¼šç”Ÿæ°”+å»¶å¹´/ä¼ä½ å¯åŒ–è§£ã€‚æ£€æŸ¥å·ç ä¸­æ˜¯å¦æœ‰ 14+19 æˆ– 14+11 ç»„åˆã€‚</div>`;
        }

        // è½¦ç‰Œç‰¹åˆ«å»ºè®®
        if (currentMode === 'car' && stats.types['WuGui'] > 0) {
             html += `<div class="advice-box" style="border-color:red">ğŸš— <strong>è¡Œè½¦å®‰å…¨ï¼š</strong> è½¦ç‰Œå¸¦äº”é¬¼ï¼Œæ˜“æœ‰çªå‘çŠ¶å†µã€‚å»ºè®®è½¦å†…æ‘†æ”¾â€œç”Ÿæ°”+å¤©åŒ»+å»¶å¹´â€ç»„åˆçš„é¥°å“è¿›è¡ŒåŒ–è§£ï¼ˆå¦‚æ•°å­—ä¸² 141319ï¼‰ã€‚</div>`;
        }

        if (html === '') html = '<p>æ‚¨çš„å·ç ç£åœºè¾ƒä¸ºå¹³è¡¡ï¼Œæˆ–ä¸»è¦ç”±å‰æ˜Ÿç»„æˆï¼Œæ— éœ€ç‰¹æ®ŠåŒ–è§£ã€‚</p>';
        container.innerHTML = html;
    }

    function renderChart(stats) {
        const ctx = document.getElementById('balanceChart').getContext('2d');
        if(chartInstance) chartInstance.destroy();

        chartInstance = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['å‰æ˜Ÿæ€»æ•°', 'å‡¶æ˜Ÿæ€»æ•°'],
                datasets: [{
                    label: 'èƒ½é‡å¯¹æ¯”',
                    data: [stats.good, stats.bad],
                    backgroundColor: ['#c92a2a', '#2b8a3e'],
                    borderColor: '#111',
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: { legend: { display: false } },
                scales: {
                    x: { ticks: { color: '#888' }, grid: { color: '#333' } },
                    y: { ticks: { color: '#fff' } }
                }
            }
        });
    }
</script>

</body>
</html>