<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>易经数字能量大师 - 专业版</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-gold: #d4af37;
            --bg-dark: #121212;
            --card-bg: #1e1e1e;
            --text-main: #e0e0e0;
            --accent-red: #8b0000;
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        /* Header Style */
        header {
            background: linear-gradient(180deg, #000 0%, #1a1a1a 100%);
            padding: 2rem 1rem;
            text-align: center;
            border-bottom: 2px solid var(--primary-gold);
        }

        header h1 {
            color: var(--primary-gold);
            margin: 0;
            font-size: 1.8rem;
            letter-spacing: 2px;
        }

        header p {
            font-size: 0.9rem;
            color: #888;
            margin-top: 10px;
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Input Section */
        .input-section {
            background-color: var(--card-bg);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            text-align: center;
            margin-bottom: 30px;
            border: 1px solid #333;
        }

        input[type="text"] {
            width: 80%;
            padding: 15px;
            font-size: 1.2rem;
            border: 1px solid #444;
            background: #2b2b2b;
            color: var(--primary-gold);
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
            letter-spacing: 2px;
        }

        button {
            background: linear-gradient(45deg, #d4af37, #f2d06b);
            color: #000;
            font-weight: bold;
            border: none;
            padding: 12px 40px;
            font-size: 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        button:hover {
            transform: scale(1.05);
        }

        /* Results Section */
        #result-area {
            display: none; /* Hidden by default */
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary-gold);
        }

        .card h3 {
            color: var(--primary-gold);
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
            margin-top: 0;
        }

        .grid-box {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
        }

        .digit-card {
            background: #2b2b2b;
            padding: 10px;
            text-align: center;
            border-radius: 5px;
            border: 1px solid #444;
        }

        .digit-num { font-size: 1.5rem; font-weight: bold; color: #fff; }
        .digit-gua { color: var(--primary-gold); font-size: 0.9rem; }
        .digit-elem { font-size: 0.8rem; color: #aaa; }

        /* Bagua Circle Visual Placeholder */
        .taichi-container {
            text-align: center;
            margin: 20px 0;
        }
        
        .explanation {
            font-size: 0.9rem;
            color: #ccc;
        }

        .tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin: 2px;
        }
        .tag-jin { background: #E0E0E0; color: #000; }
        .tag-mu { background: #4CAF50; color: #fff; }
        .tag-shui { background: #2196F3; color: #fff; }
        .tag-huo { background: #F44336; color: #fff; }
        .tag-tu { background: #795548; color: #fff; }

    </style>
</head>
<body>

<header>
    <h1>易经数字能量</h1>
    <p>先天为体，后天为用 · 破译数字背后的天人密码</p>
</header>

<div class="container">
    <div class="input-section">
        <label style="display:block; margin-bottom:10px; color:#aaa;">请输入手机号、车牌或任意数字串</label>
        <input type="text" id="numberInput" placeholder="例如：13912345678" maxlength="18">
        <br>
        <button onclick="analyzeNumbers()">立即测算</button>
    </div>

    <div id="result-area">
        
        <div class="card">
            <h3>单数·八卦映射分析</h3>
            <p class="explanation">根据《易经》后天八卦原理，每一个数字都对应一个卦象、五行及六亲关系。</p>
            <div class="grid-box" id="digit-breakdown">
                </div>
        </div>

        <div class="card">
            <h3>五行能量平衡图</h3>
            <p class="explanation">数字组合中金木水火土的分布情况，反映了运势的强弱与缺失。</p>
            <canvas id="elementChart" height="200"></canvas>
            <div id="element-advice" style="margin-top:15px; font-size:0.9rem;"></div>
        </div>

        <div class="card">
            <h3>六亲与家庭角色映射</h3>
            <div id="family-analysis">
                </div>
        </div>

        <div class="card">
            <h3>数字能量总评</h3>
            <div id="summary-text" style="font-style: italic; color: #d4af37;"></div>
        </div>

    </div>
</div>

<script>
    // 核心数据字典：依据用户提供的易经体系配置
    const yiJingData = {
        '1': { gua: '坎', name: '坎水', element: '水', relation: '中男', color: 'tag-shui', meaning: '智慧、险陷、流动' },
        '2': { gua: '坤', name: '坤土', element: '土', relation: '老母', color: 'tag-tu', meaning: '包容、厚德、承载' },
        '3': { gua: '震', name: '震木', element: '木', relation: '长男', color: 'tag-mu', meaning: '行动、雷动、生发' },
        '4': { gua: '巽', name: '巽木', element: '木', relation: '长女', color: 'tag-mu', meaning: '柔顺、风行、入围' },
        '5': { gua: '中', name: '中央土', element: '土', relation: '中央', color: 'tag-tu', meaning: '核心、稳固、显化' },
        '6': { gua: '乾', name: '乾金', element: '金', relation: '老父', color: 'tag-jin', meaning: '威严、领导、刚健' },
        '7': { gua: '兑', name: '兑金', element: '金', relation: '少女', color: 'tag-jin', meaning: '口才、喜悦、缺损' },
        '8': { gua: '艮', name: '艮土', element: '土', relation: '少男', color: 'tag-tu', meaning: '停止、稳重、山岳' },
        '9': { gua: '离', name: '离火', element: '火', relation: '中女', color: 'tag-huo', meaning: '热情、光明、依附' },
        '0': { gua: '中', name: '中央土', element: '土', relation: '中央', color: 'tag-tu', meaning: '隐藏、空亡、归零' }
    };

    let chartInstance = null;

    function analyzeNumbers() {
        const input = document.getElementById('numberInput').value;
        const resultArea = document.getElementById('result-area');
        
        if (!input || !/^\d+$/.test(input)) {
            alert("请输入纯数字（如手机号）");
            return;
        }

        // 显示结果区域
        resultArea.style.display = 'block';

        // 1. 生成单数字分析网格
        const gridContainer = document.getElementById('digit-breakdown');
        gridContainer.innerHTML = ''; // 清空旧数据
        
        const digits = input.split('');
        const elementCounts = { '金': 0, '木': 0, '水': 0, '火': 0, '土': 0 };
        const familyRelations = [];

        digits.forEach(num => {
            const data = yiJingData[num];
            
            // 统计五行
            if(data.element) elementCounts[data.element]++;
            
            // 收集六亲
            if(data.relation && data.relation !== '中央') familyRelations.push(data.relation);

            // 创建DOM
            const div = document.createElement('div');
            div.className = 'digit-card';
            div.innerHTML = `
                <div class="digit-num">${num}</div>
                <div class="digit-gua">${data.gua}为${data.name}</div>
                <div class="digit-elem"><span class="tag ${data.color}">${data.element}</span></div>
                <div style="font-size:0.75rem; margin-top:5px;">${data.relation}</div>
            `;
            gridContainer.appendChild(div);
        });

        // 2. 渲染五行图表
        renderChart(elementCounts);
        generateAdvice(elementCounts);

        // 3. 渲染六亲分析
        const familyContainer = document.getElementById('family-analysis');
        if(familyRelations.length > 0) {
            const uniqueRelations = [...new Set(familyRelations)];
            familyContainer.innerHTML = `<p>此组数字中显现的家庭六亲角色有：<br> <strong style="color:#d4af37">${uniqueRelations.join('， ')}</strong></p>
            <p style="font-size:0.9rem; color:#aaa;">注：缺少某种角色并不代表没有亲人，而是指在该数字磁场中，该角色的能量较弱或未显化。</p>`;
        } else {
            familyContainer.innerHTML = '<p>此组数字主要由中央土构成，六亲关系较为隐晦。</p>';
        }

        // 4. 生成总评 (简单的逻辑演示)
        const summaryDiv = document.getElementById('summary-text');
        const maxElement = Object.keys(elementCounts).reduce((a, b) => elementCounts[a] > elementCounts[b] ? a : b);
        summaryDiv.innerHTML = `此号码中 <strong>[${maxElement}]</strong> 的能量最强。<br>
        根据易经原理，${getSummary(maxElement)}`;
    }

    // 辅助函数：图表渲染
    function renderChart(counts) {
        const ctx = document.getElementById('elementChart').getContext('2d');
        
        if(chartInstance) chartInstance.destroy();

        chartInstance = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['金', '木', '水', '火', '土'],
                datasets: [{
                    data: [counts['金'], counts['木'], counts['水'], counts['火'], counts['土']],
                    backgroundColor: ['#E0E0E0', '#4CAF50', '#2196F3', '#F44336', '#795548'],
                    borderColor: '#1e1e1e',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: { color: '#ccc' }
                    }
                }
            }
        });
    }

    // 辅助函数：生成建议
    function generateAdvice(counts) {
        const adviceDiv = document.getElementById('element-advice');
        let missing = [];
        for(let key in counts) {
            if(counts[key] === 0) missing.push(key);
        }
        
        if(missing.length > 0) {
            adviceDiv.innerHTML = `⚠️ <strong>五行缺漏提示：</strong> 您的数字组合中缺少 <strong>${missing.join('、')}</strong> 元素，建议通过佩戴相应颜色的饰品或调整后天环境进行补益。`;
        } else {
            adviceDiv.innerHTML = `✅ <strong>五行平衡：</strong> 您的数字组合五行俱全，能量循环较为流畅。`;
        }
    }

    // 辅助函数：总评文案
    function getSummary(element) {
        const map = {
            '金': '金气过旺，行事果断刚毅，需注意刚过易折，宜多修柔德。',
            '木': '木气充盈，生机勃勃，仁慈宽厚，但需防优柔寡断。',
            '水': '水气强盛，智慧超群，善于应变，但需防心思过重或漂泊不定。',
            '火': '火气旺盛，热情懂礼，但也容易急躁冲动，需注意心脏与眼部保养。',
            '土': '土气厚重，诚信稳重，包容力强，但有时可能过于固执保守。'
        };
        return map[element] || '';
    }
</script>

</body>
</html>